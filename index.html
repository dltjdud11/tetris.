<script>
    // [중략]...

    // --- 이벤트 리스너 ---

    // PC 키보드 이벤트 (변동 없음)
    document.addEventListener('keydown', (e) => {
        if (!timerId) return; 

        if (e.key === 'ArrowLeft') move(-1);
        else if (e.key === 'ArrowRight') move(1);
        else if (e.key === 'ArrowDown') fall();
        else if (e.key === 'ArrowUp') rotate();
    });

    // **모바일/터치 버튼 이벤트 (수정된 부분)**
    // 'touchstart'와 'e.preventDefault()'를 사용하여 모바일에서 즉각적인 반응을 보장합니다.
    
    // 왼쪽 버튼
    controls.left.addEventListener('touchstart', (e) => { 
        e.preventDefault(); 
        move(-1); 
    });

    // 오른쪽 버튼
    controls.right.addEventListener('touchstart', (e) => { 
        e.preventDefault(); 
        move(1); 
    });

    // 아래 버튼
    controls.down.addEventListener('touchstart', (e) => { 
        e.preventDefault(); 
        fall(); 
    });
    
    // 회전 버튼
    controls.rotate.addEventListener('touchstart', (e) => { 
        e.preventDefault(); 
        rotate(); 
    });


    // 게임 시작/일시정지 버튼 (클릭 이벤트 유지)
    startButton.addEventListener('click', () => {
        if (timerId) {
            // 일시 정지
            clearInterval(timerId);
            timerId = null;
            startButton.textContent = 'RESUME';
        } else {
            if (startButton.textContent === 'START' || startButton.textContent === 'RESTART') {
                // 새 게임 시작
                createBoard(); 
                score = 0;
                scoreElement.textContent = score;
                generateTetromino();
            }
            
            // 게임 재개 또는 시작
            timerId = setInterval(fall, 800); 
            startButton.textContent = 'PAUSE';
        }
    });

    // [후략]...
</script>
